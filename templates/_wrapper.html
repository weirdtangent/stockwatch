{{- define "_header" -}}
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="google-signin-client_id" content="602086455575-vj2spkou0ucsntgol9srfkf8mka3o5i2.apps.googleusercontent.com">
    <link href="/static/css/custom-dark.css" rel="stylesheet">
    <link href="/static/vendor/fontawesome/css/all.css" rel="stylesheet">
    <link href="/static/css/internal.css" rel="stylesheet">
    <title>Graystorm StockWatch</title>
  </head>

  <body id="page-top" class="{{.config.TmplName}}">
    <script src="/static/vendor/jquery/jquery-3.5.1.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- Navigation -->
    <div class="">
      <div class="row g-0"><!-- row -->
        <div class="col-6 col-sm-5 col-md-4 col-lg-3 col-xxl-2 bg-dark full-height"><!-- left column -->
          <div class="logo">
            <a href="/"><img class="img-fluid mx-auto d-block logo" src="/static/images/logo/stockwatch-200.png"></a>
          </div>
          {{ template "_sidemenu" . }}
        </div><!-- left column -->

        <div class="col-6 col-sm-7 col-md-8 col-lg-9 col-xxl-10"><!-- content -->
          <div class="d-flex bg-dark menubar">
          {{if not .hideRecents}}
            <ul class="flex-grow-1 nav me-auto mb-2 mb-lg-0 pt-2 ps-2">
            {{if .recents.ViewPairs}}
              <li class="nav-item me-1 pt-2">Recent:</li>
              {{range .recents.ViewPairs -}}
              <li class="nav-item me-1 pt-2 recent"><a href="/view/{{.Symbol}}/{{.Acronym}}"><button type="button" class="badge text-dark bg-warning"><i class="fas fa-dollar-sign"></i>{{.Symbol}}</button></a></li>
              {{end -}}
            {{end -}}
            </ul>
          {{end -}}
          {{if .WID}}
            <div class="bg-dark text-success align-self-center mx-2 pt-2 ps-2">
              <a class="text-decoration-none" href="/account">
                <span class="pe-2 align-items-baseline">My Account</span>
              {{if .watcher.IsRoot}}
                <span><i class="fas fa-user-secret fa-2x"></i></span>
              {{else if .watcher.IsAdmin}}
                <span><i class="fas fa-user-cog fa-2x"></i></span>
              {{else if .watcher.IsModerator}}
                <span><i class="fas fa-user-shield fa-2x"></i></span>
              {{else if .watcher.IsProfessional}}
                <span><i class="fas fa-user-plus fa-2x"></i></span>
              {{else}}
                <span><i class="far fa-user fa-2x"></i></span>
              {{end}}
              </a>
          </div>
          {{end}}
        </div>
{{- end}}

{{- define "_messages" -}}
                  {{if .messages.Messages }}
                    {{range .messages.Messages }}
                      <div class="pe-2 text-{{.Level}}">{{.Text}}</div>
                    {{end}}
                  {{end}}
{{- end}}

{{- define "_messageblock" -}}
            {{if .messages.Messages }}
              <figure>
                <figcaption class="py-2">Messages:</figcaption>
                <ul class="mx-2 list-group">
                {{range .messages.Messages }}
                  <li class="list-group-item text-{{.Level}}">{{.Text}}</li>
                {{end}}
                </ul>
              </figure>
            {{end}}
{{- end}}

{{- define "_sidemenu" -}}
          <div class="pt-3">
        {{if .WID}}
          {{if .profilePicURL}}
            <div class="my-2 text-center">
              <img class="image-fluid rounded" src="{{.profilePicURL}}">
            </div>
          {{end}}
            <ul class="nav flex-column me-auto mb-2 mb-lg-0">
              <li class="nav-item w-100 text-warning text-center welcome">Welcome back<br>{{.watcher.WatcherName}}!</li>
              <li class="nav-item"><a class="nav-link" href="#section1">Account</a></li>
              <li class="nav-item"><a class="nav-link" href="#section2">Holdings</a></li>
              <li class="nav-item"><a class="nav-link" href="#section3">Preferences</a></li>
              <li class="nav-item g_id_signout"><a class="nav-link" href="/logout" class="signout">Disconnect Google</a></li>
            {{if .watcher.IsAdmin}}
              <li class="nav-item"><a class="nav-link link-warning" href="/update/exchanges">Update Exchanges</a></li>
            {{end}}
            </ul>
            <div class="bg-primary my-2 p-2 g-0">
              <form method="POST" action="/search/ticker" class="form-control bg-primary no-border ps-4">
                <input class="row mb-2 form-control-sm" name="searchString" type="search" placeholder="Symbol/Company name" aria-label="Symbol Search">
                <button class="row mt-2 form-control-sm bg-light text-dark" type="submit">Search</button>
              </form>
            </div>
        {{end -}}
        {{ if .allowLogin }}
            <div id="g_id_onload"
               data-client_id="602086455575-vj2spkou0ucsntgol9srfkf8mka3o5i2.apps.googleusercontent.com"
               data-auto_select="true" data-context="use" data-login_uri="https://stockwatch.graystorm.com/login">
            </div>
        {{end}}
          </div>
{{- end}}

{{- define "_share_price" -}}
  {{ printf "$%.2f" .daily.ClosePrice }}
  {{if eq .lastDailyMove "up"}}<i class="fas fa-arrow-up text-success"></i>
  {{else if eq .lastDailyMove "down"}}<i class="fas fa-arrow-down text-danger"></i>
  {{end}}at close on <a href="/view/{{.ticker.TickerSymbol}}/{{.exchange.ExchangeAcronym}}/{{.daily.PriceDate}}">{{ .daily.PriceDate }}</a>
{{- end}}

{{- define "_ticker_top" -}}
              <header class="bg-dark pt-2 ps-2">
                <div class="d-flex">
                  <div>
                    <h3>Symbol: <a class="link-light" href="/view/{{.ticker.TickerSymbol}}/{{.exchange.ExchangeAcronym}}">{{.ticker.TickerSymbol}}</a> ({{.exchange.ExchangeAcronym}})</h3>
                    <h5>{{.ticker.TickerName}}</h5>
                    <h6 class="small text-info">Share price: <span class="text-light">{{ template "_share_price" . }}</span></h6>
                  </div>
                  <div class="flex-grow-1 text-end">
                    {{ template "_messages" . }}
                  </div>
                </div>
                <div class="d-flex">
                  <div class="flex-grow-1 pt-1 pb-2" id="toggle">
                    <hr class="mt-0 mb-2 text-white opacity-3">
                    <div class="btn-group" role="group" aria-label="Chart or table to show">
                      <input type="radio" class="btn-check" name="pickChart" id="tickerChart1" autocomplete="off" checked>
                      <label class="btn-sm btn-outline-success mx-1" for="tickerChart1"><i class="fas fa-chart-line"></i> Line</label>

                      <input type="radio" class="btn-check" name="pickChart" id="tickerChart2" autocomplete="off">
                      <label class="btn-sm btn-outline-success mx-1" for="tickerChart2"><i class="fas fa-chart-bar"></i> Candlestick</label>

                      <input type="radio" class="btn-check" name="pickChart" id="tickerChart3" autocomplete="off">
                      <label class="btn-sm btn-outline-success mx-1" for="tickerChart3"><i class="fas fa-table"></i> Table</label>
                    </div>
                  </div>
                </div>
              </header>
{{- end}}

{{- define "_chart_js" -}}
    <script src="/static/vendor/echarts/dist/echarts.min.js"></script>
    <script src="/static/vendor/echarts/theme/vintage.js"></script>
{{- end}}

{{- define "_footer" -}}
        </div><!-- wrapper col -->
      </div><!-- wrapper row -->
    </div><!-- wrapper screen -->

    <!-- Footer -->
    <footer class="footer fixed-bottom fs-6 align-middle text-light row">
        <div class="col-2">
          <p class="lh-1 small">
            <a class="py-0 mt-0" href="/privacy">Privacy Policy</a><br>
            contact <a href="mailto:privacy@graystorm.com" class="text-decoration-none">privacy@graystorm.com</a>
          </p>
          <p class="lh-1 small"><a class="py-0 mt-0" href="/terms">Terms and Conditions</a></p>
          <p class="lh-1 small">
            Market data provided by <a href="https://marketstack.com" target="_blank">marketstack.com</a>
          </p>
          <p class="lh-1 small">
            &copy;2021 -
            <a href="mailto:jeff@graystorm.com" class="text-decoration-none">jeff@graystorm.com</a>
          </p>
        </div>
    </footer>

  </body>
</html>
{{- end}}
